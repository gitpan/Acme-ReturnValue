[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub deutschepostcheck {\n\tmy $paketnummer = shift;\n\tmy $tag = shift;\n\tmy $monat = shift;\n\tmy $jahr = shift;\n\n\tmy %post;\n\t$post{'form.sendungsnummer'} = $paketnummer;\n\t$post{'form.einlieferungsdatum_tag'} = $tag;\n\t$post{'form.einlieferungsdatum_monat'} = $monat;\n\t$post{'form.einlieferungsdatum_jahr'} = $jahr;\n\tmy $ua = LWP::UserAgent->new;\n\tmy $response = $ua->post('https://www.deutschepost.de/sendung/simpleQueryResult.html', \\%post );\n\tmy $data1 = $response->content;\n\n\tmy($detail) = ($data1 =~ /<div class=\"pk-result-element-one\">(.*)<div id=\"buttons\">/i);\n\tmy($laststatus) = ($data1 =~ /<div class=\"pk-result-element-one\">([^<]*)<div class=\"pk-result-links\">/si);\n\tmy($signature) = ($data1 =~ /<div class=\"pk-result-link\"><a href=\"javascript: callPopUpReceipt\\('Belegzugriffspfad=([^']*)'\\)\" class=\"link\">Auslieferungsbeleg anzeigen<\\/a><\\/div>/i);\n\t$laststatus =~ s/[\\n\\r]//g;\n\t$laststatus =~ s/^\\s*//g;\n\t$laststatus =~ s/\\s\\s*/ /g;\n\t$laststatus =~ s/,\\s*/, /g;\n\t$signature =~ s/&amp;/\\%26/g;\n\t$signature =~ s/=/\\%3D/g;\n\n\tmy $pictureurl;\n\tmy $picturedata;\n\tmy $signaturedata;\n\tif($signature){\n\t\t$signaturedata = get('https://www.deutschepost.de/sendung/receipt.html?receiptUrl=Belegzugriffspfad%3D'.$signature);\n\t\t($pictureurl) = ($signaturedata =~ /<img src=\"([^\"]*)\"/);\n\t\t($picturedata) = get('https://www.deutschepost.de'.$pictureurl);\n\t}\n\n\treturn(({\n\t\t'shipnumber' => $paketnummer,\n\t\t'laststatus' => $laststatus,\n\t\t'signature' => 'https://www.deutschepost.de/sendung/receipt.html?receiptUrl=Belegzugriffspfad%3D'.$signature,\n\t\t'pictureurl' => 'https://www.deutschepost.de'.$pictureurl,\n\t\t'picture' => encode_base64($picturedata, ''),\n\t\t})\n\t);\n}",
      "file" : "/var/tmp/arv_38lKXS/WWW-Deutschepost-Detail/Detail.pm",
      "package" : "WWW::Deutschepost::Detail"
   }
]
