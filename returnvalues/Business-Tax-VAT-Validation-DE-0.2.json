[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub bffcheck {\n\tmy $deVAT = shift || '';\n\tmy $myVAT = shift || '';\n\tmy $Firmenname = shift || '';\n\tmy $Ort = shift || '';\n\tmy $PLZ = shift || '';\n\tmy $Strasse = shift || '';\n\tmy $Druck = shift || '';\n\t$Druck = \"nein\" if($Druck ne \"nein\" && $Druck ne \"ja\");\n\tmy $hvatn = Business::Tax::VAT::Validation->new();\n\tmy $hvatn2 = Business::Tax::VAT::Validation->new();\n\tmy %newdata;\n\tif($hvatn->check($deVAT) && $hvatn2->check($myVAT)){\n\n\t\tmy $data = get(\"http://evatr.bff-online.de/evatrRPC?UstId_1=$deVAT&UstId_2=$myVAT&Firmenname=$Firmenname&Ort=$Ort&PLZ=$PLZ&Strasse=$Strasse&Druck=$Druck\");\n\t\tif($data){\n\t\t\tmy $ref = XMLin($data);\n\t\t\tfor(my $i = 0; $i < @{$ref->{'param'}}; $i++){\n\t\t\t\tif(ref(${${${${$ref->{'param'}}[$i]}{'value'}{'array'}{'data'}{'value'}}[1]}{'string'}) ne 'HASH'){\n\t\t\t\t\t$newdata{${${${${$ref->{'param'}}[$i]}{'value'}{'array'}{'data'}{'value'}}[0]}{'string'}} = ${${${${$ref->{'param'}}[$i]}{'value'}{'array'}{'data'}{'value'}}[1]}{'string'};\n\t\t\t\t}else{\n\t\t\t\t\t$newdata{${${${${$ref->{'param'}}[$i]}{'value'}{'array'}{'data'}{'value'}}[0]}{'string'}} = \"\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif($newdata{'Druck'} eq $Druck && $newdata{'ErrorCode'} eq \"200\" && !$newdata{'Erg_PLZ'} && !$newdata{'Erg_Ort'} && !$newdata{'Erg_Str'} && !$newdata{'Erg_Name'} or $newdata{'Druck'} eq $Druck && $newdata{'ErrorCode'} eq \"200\" && $newdata{'Erg_PLZ'} eq \"A\" && $newdata{'Erg_Ort'} eq \"A\" && $newdata{'Erg_Str'} eq \"A\" && $newdata{'Erg_Name'} eq \"A\"){\n\t\t\t\treturn 1,%newdata;\n\t\t\t}else{\n\t\t\t\treturn 0,%newdata;\n\t\t\t}\n\t\t}else{\n\t\t\t$newdata{'ErrorCode'} = \"Timeout\";\n\t\t\treturn 0,%newdata;\n\t\t}\n\t}else{\n\t\t$newdata{'ErrorCode'} = \"$deVAT: \" . $hvatn->get_last_error_code . \" \" . $hvatn->get_last_error . \" - $myVAT: \" . $hvatn->get_last_error_code . \" \" . $hvatn->get_last_error;\n\t\treturn 0,%newdata;\n\t}\n}",
      "file" : "/var/tmp/arv_pqDxut/Business-Tax-VAT-Validation-DE/DE.pm",
      "package" : "Business::Tax::VAT::Validation::DE"
   }
]
