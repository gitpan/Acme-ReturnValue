[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub import {\n    my ( undef, $runtime )= @_;\n\n    die \"Must specify a time until which the script should run\\n\"\n      if !defined $runtime;\n\n    my $cpu= ( $runtime =~ s#[cC]## );\n    $cpu= undef if $runtime =~ s#[wW]##;\n\n    die \"Unrecognizable runtime specified: $runtime\\n\"\n      if $runtime !~ m#^[sSmMhHdD\\d]+$#;\n\n    my $seconds= 0;\n    $seconds += $1             if $runtime =~ m#(\\d+)[sS]?#;\n    $seconds += ( 60 * $1 )    if $runtime =~ m#(\\d+)[mM]#;\n    $seconds += ( 3600 * $1 )  if $runtime =~ m#(\\+?\\d+)[hH]#;\n    $seconds += ( 86400 * $1 ) if $runtime =~ m#(\\+?\\d+)[dD]#;\n\n    if ($cpu) {\n\n        pipe my $child, my $parent;\n        my $pid= fork();\n        die \"Could not fork: $!\\n\" unless defined $pid;\n        \n        if ( !$pid ) {\n            close $child;\n            require IO::Handle;\n            $parent->autoflush;\n\n            $SIG{INFO}= sub {\n                my @time= times;\n                my $time= $time[0] + $time[1] + $time[2] + $time[3];\n                printf $parent \"%.0f\\n\",$time;\n            };\n\n            return;\n        }        \n\n        $SIG{CHLD}= sub { exit };\n\n        close $parent;\n        my $rbits;\n        vec( $rbits, fileno( $child), 1 )= 1;\n\n        my $burnt= 0;\n        while ( $burnt < $seconds ) {\n            sleep $seconds - $burnt;\n\n            kill SIGINFO, $pid;\n            until ( select $rbits, undef, undef, 1 ) {\n                exit if kill SIGALIVE, $pid;\n            }\n\n            exit if !defined( $burnt= readline $child );\n        }\n\n        kill SIGTERM, $pid;\n        exit;\n    }\n\n    else {\n        my $pid= fork();\n        die \"Could not fork: $!\\n\" if !defined $pid;\n\n        return if !$pid;  \n\n        $SIG{ALRM}= sub {\n            kill SIGTERM, $pid;\n            exit 1;\n        };\n\n        alarm $seconds;\n        wait;\n\n        exit;\n    }\n}",
      "file" : "/var/tmp/arv_ZLxfqp/Sys-RunUntil-0.04/lib/Sys/RunUntil.pm",
      "package" : "Sys::RunUntil"
   }
]
