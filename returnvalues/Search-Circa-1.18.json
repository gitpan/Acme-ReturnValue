[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub check_links\n  {\n    my($self,$tag,$links) = @_;\n    my $host = $self->{INDEXER}->host_indexed;\n    my $li = \"doc|zip|ps|gif|jpg|gz|pdf|eps|png|deb|xls|ppt|\".\n\t     \"class|GIF|css|js|wav|mid\";\n    my $bad = qr/\\.($li)$/i;\n    if (($tag) && ($links) && ($tag eq 'a') \n\t&& ($links=~/\\Q$host\\E/) \n\t&& ($links !~ $bad))\n    {\n      if ($links=~/^(.*?)#/) {$links=$1;} \n      if ((!$self->{ConfigMoteur}->{'indexCgi'})&&($links=~/^(.*?)\\?/)) \n\t  {$links=$1;}\n      return $links;\n    }\n   return 0;\n  }",
      "file" : "/var/tmp/arv_dr2gec/Search-Circa-1.18/lib/Search/Circa/Parser.pm",
      "package" : "Search::Circa::Parser"
   },
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub get_link\n  {\n  my ($self,$script_name,$no_categorie,$id,$first) = @_;\n  if (defined($first)) \n    {return $script_name.\"?categorie=$no_categorie&id=$id&first=$first\";}\n  else {return $script_name.\"?categorie=$no_categorie&id=$id\";}\n  }",
      "file" : "/var/tmp/arv_dr2gec/Search-Circa-1.18/lib/Search/Circa/Categorie.pm",
      "package" : "Search::Circa::Categorie"
   },
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub get_link_categorie\n  {\n  my ($self,$no_categorie,$id,$first) = @_;\n  if (!defined($first)) { $first = 0; }\n  if (defined($no_categorie)) \n    {return $self->{SCRIPT_NAME}.\"?categorie=$no_categorie&id=$id&first=$first\";}\n  else {return $self->{SCRIPT_NAME}.\"?id=$id&first=$first\";}\n  }",
      "file" : "/var/tmp/arv_dr2gec/Search-Circa-1.18/lib/Search/Circa/Annuaire.pm",
      "package" : "Search::Circa::Annuaire"
   },
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub get_liste_langues\n  {\n  my ($self,$id,$valeur,$cgi)=@_;\n  my @l;\n  my $sth = $self->{DBH}->prepare(\"select distinct langue \".\n\t\t\t\t  \"from \".$self->pre_tbl.$id.\"links\");\n  $sth->execute() || print \"Erreur: $DBI::errstr\\n\";\n  while (my ($l)=$sth->fetchrow_array) {push(@l,$l);}\n  $sth->finish;\n  my %langue=(\n\t      'unkno'=>'unkno',\n\t      'da'=>'Dansk',\n\t      'de'=>'Deutsch',\n\t      'en'=>'English',\n\t      'eo'=>'Esperanto',\n\t      'es'=>'Espan�l',\n\t      'fi'=>'Suomi',\n\t      'fr'=>'Francais',\n\t      'hr'=>'Hrvatski',\n\t      'hu'=>'Magyar',\n\t      'it'=>'Italiano',\n\t      'nl'=>'Nederlands',\n\t      'no'=>'Norsk',\n\t      'pl'=>'Polski',\n\t      'pt'=>'Portuguese',\n\t      'ro'=>'Rom�n�',\n\t      'sv'=>'Svenska',\n\t      'tr'=>'TurkCe',\n\t      '0'=>'All'\n    );\n  my $scrollLangue =\n    $cgi->scrolling_list(  -'name'=>'langue',\n                             -'values'=>\\@l,\n                             -'size'=>1,\n                             -'default'=>$valeur,\n                             -'labels'=>\\%langue);\n  }",
      "file" : "/var/tmp/arv_dr2gec/Search-Circa-1.18/lib/Search/Circa/Indexer.pm",
      "package" : "Search::Circa::Indexer"
   },
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub non_valide  {\n  my ($this,$compte,$id_url)=@_;\n  my $r=$this->{DBH}->do(\"update \".$this->{INDEXER}->pre_tbl.$compte.\"links\".\n\t\t\t \" set valide='0' where id=\".$id_url) \n    || return 0;\n  return ((!$r or $r eq '0E0') ? 0 : 1);\n  }",
      "file" : "/var/tmp/arv_dr2gec/Search-Circa-1.18/lib/Search/Circa/Url.pm",
      "package" : "Search::Circa::Url"
   }
]
