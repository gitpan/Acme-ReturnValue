[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub get_default_browser\n{\n\t my $browser_str = '';\n\t my $sub_browser_str = '';\n\t my $fallback = 0;\n\t my $is64bit = 0;\n     if($ENV{'PROGRAMW6432'} =~ m/\\w/)\n     {\n          $is64bit = 1;\n     }\n\t if(($is64bit) && (-e ($ENV{'SYSTEMDRIVE'} . '\\\\Program Files (x86)\\\\Internet Explorer\\\\iexplore.exe')))\n\t {\n\t\t  $fallback = $ENV{'SYSTEMDRIVE'} . '\\\\Program Files (x86)\\\\Internet Explorer\\\\iexplore.exe';\n\t }\n\t elsif(-e ($ENV{'SYSTEMDRIVE'} . '\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe'))\n\t {\n\t\t  $fallback = $ENV{'SYSTEMDRIVE'} . '\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe';\n\t }\n\t if(! $fallback)\n\t {\n\t\t  $fallback = 'iexplore.exe';\n\t }\n\t my($junkstr, $major, $junkminor, $junkbuild) = Win32::GetOSVersion();\n\t if($major > 5)\n\t {\n\t\t  my $regkey = new Win32::TieRegistry('HKEY_CURRENT_USER\\\\Software\\\\Clients\\\\StartMenuInternet', { Access => KEY_READ(), Delimiter => '\\\\' });\n\t\t  if ($regkey)\n\t\t  {\n\t\t\t  $browser_str = $regkey->GetValue('');\n\t\t\t  if($browser_str)\n\t\t\t  {\n\t\t\t\t\tmy $regpath_str = 'HKEY_LOCAL_MACHINE\\\\Software\\\\Clients\\\\StartMenuInternet\\\\' . $browser_str . '\\\\shell\\\\open\\\\command';\n\t\t\t\t\tif($is64bit)\n\t\t\t\t\t{\n\t\t\t\t\t\t $regpath_str = 'HKEY_LOCAL_MACHINE\\\\Software\\\\Wow6432Node\\\\Clients\\\\StartMenuInternet\\\\' . $browser_str . '\\\\shell\\\\open\\\\command';\n\t\t\t\t\t}\n\t\t\t\t\tmy $sub_regkey = new Win32::TieRegistry($regpath_str, { Access => KEY_READ(), Delimiter => '\\\\' });\n\t\t\t\t\tif($sub_regkey)\n\t\t\t\t\t{\n\t\t\t\t\t\t $sub_browser_str = $sub_regkey->GetValue('');\n\t\t\t\t\t}\n\t\t\t  }\n\t\t  }\n\t\t  $sub_browser_str =~ s/[\"']//g;\n\t }\n\t else\n\t {\n\t\t  my $regkey = new Win32::TieRegistry('HKEY_CLASSES_ROOT\\\\HTTP\\\\shell\\\\open\\\\command', { Access => KEY_READ(), Delimiter => '\\\\' });\n\t\t  if ($regkey)\n\t\t  {\n\t\t\t   $sub_browser_str = $regkey->GetValue('');\n\t\t\t   $sub_browser_str =~ s/(\\.exe).{1,}$/$1/i;\n\t\t\t   $sub_browser_str =~ s/[\"']//g;\n\t\t  }\n\t }\n\t if((! (length($sub_browser_str))) || (!-e $sub_browser_str))\n\t {\n\t\t  $sub_browser_str = $fallback;\n\t }\n\t return($sub_browser_str);\n}",
      "file" : "/var/tmp/arv_Xmx8_P/Win32-GetDefaultBrowser-1.00/lib/Win32/GetDefaultBrowser.pm",
      "package" : "Win32::GetDefaultBrowser"
   }
]
