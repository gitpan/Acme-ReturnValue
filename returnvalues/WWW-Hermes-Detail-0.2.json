[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub hermescheck {\n\tmy $paketnummer = shift;\n\tmy $language = shift || 'de';\n\n\tmy @newdata;\n\tmy $firstdata1 = get('https://www.myhermes.de/wps/portal/PRIPS_DEU/SENDUNGSSTATUS');\n\tmy($nextpostlink) = ($firstdata1 =~ /<form name=\"[^\"]*_AuftragSucheForm\" method=\"post\" action=\"([^\"]*)\">/);\n\n\tmy %post;\n\t$post{'auftragsNummer'} = $paketnummer;\n\t$post{'quittungsNummer'} = '';\n\tmy $ua = LWP::UserAgent->new;\n\tmy $response = $ua->post('https://www.myhermes.de'.$nextpostlink, \\%post );\n\tmy $data = $response->content;\n\t$data =~ s/[\\n\\r]//g;\n\n\tmy($detail) = ($data =~ /<div id=\"formBox\" class=\"sendungsstatus\">\\s*(.*?)<div class=\"submit\" >/);\n\tmy($detail2) = ($detail =~ /<br>\\s*<div id=\"sisyTabelle\">(.*?)<\\/table>/);\n\twhile($detail2 =~ /<tr>(.*?)<\\/tr>/ig){\n\t\tmy $detailone = $1;\n\n\t\tmy($datum,$zeit,$daten) = ($detailone =~ /<td class=\"content\">\\s*([^<]*)\\s*<\\/td>\\s*<td class=\"content\">\\s*([^<]*)\\s*<\\/td>\\s*<td class=\"content\">\\s*([^<]*)\\s*<\\/td>/);\n\t\t$datum =~ s/\\s\\s*/ /g;\n\t\t$zeit =~ s/\\s\\s*/ /g;\n\t\t$daten =~ s/\\s\\s*/ /g;\n\t\tmy %details;\n\t\t$details{'datum'} = $datum . \" \" . $zeit;\n\t\t$details{'daten'} = $daten;\n\t\tpush(@newdata,\\%details)\n\t}\n\tmy($to,$paketnumber,$pickupdate,$deliverydate,$laststatus) = ($detail =~ /<td class=\"content\">\\s*([^<]*)\\s*<\\/td>\\s*<td class=\"content\">\\s*([^<]*)\\s*<\\/td>\\s*<td class=\"content\">\\s*([^<]*)\\s*<\\/td>\\s*<td class=\"content\">\\s*([^<]*)\\s*<\\/td>\\s*<td class=\"content\">\\s*([^<]*)\\s*<\\/td>/i);\n\n\treturn(\\@newdata,({\n\t\t'shipnumber' => $paketnumber,\n\t\t'to' => $to,\n\t\t'pickupdate' => $pickupdate,\n\t\t'deliverydate' => $deliverydate,\n\t\t'laststatus' => $laststatus,\n\t\t})\n\t);\n}",
      "file" : "/var/tmp/arv_V99EJL/WWW-Hermes-Detail/Detail.pm",
      "package" : "WWW::Hermes::Detail"
   }
]
