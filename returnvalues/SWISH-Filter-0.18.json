[
   {
      "PPI" : "PPI::Statement::Sub",
      "bad" : "sub get_xls_content_ref {\n    my ( $self, $file, $doc ) = @_;\n\n    my $oExcel = Spreadsheet::ParseExcel->new;\n    return unless $oExcel;\n\n    my $oBook = $oExcel->Parse($file) || return;\n    my ( $iR, $iC, $oWkS, $oWkC, $ExcelWorkBook );\n\n    my ( $vol, $dirs, $filename ) = File::Spec->splitpath( $oBook->{File} );\n\n    my $user_meta = $doc->meta_data || {};\n\n    my %meta = (\n        Filename   => $filename,\n        Version    => $oBook->{Version} || '',\n        Author     => $oBook->{Author} || '',\n        Sheetcount => $oBook->{SheetCount}\n    );\n\n    $meta{$_} = $user_meta->{$_} for keys %$user_meta;\n\n    my $title = join( ' ',\n        $oBook->{Worksheet}[0]->{Name},\n        $filename, 'v.' . $meta{Version} );\n\n    my $html = join( \"\\n\",\n        '<html>', '<head>',\n        '<title>' . $self->escapeXML($title) . '</title>',\n        $self->format_meta_headers( \\%meta ), '</head>' );\n\n    $html .= \"\\n\";\n\n    for ( my $iSheet = 0; $iSheet < $oBook->{SheetCount}; $iSheet++ ) {\n\n        $oWkS = $oBook->{Worksheet}[$iSheet];\n\n        my $ExcelWorkSheet\n            = \"<h2>\" . $self->escapeXML( $oWkS->{Name} ) . \"</h2>\\n\";\n        $ExcelWorkSheet .= \"<table>\\n\";\n\n        for (\n            my $iR = $oWkS->{MinRow};\n            defined $oWkS->{MaxRow} && $iR <= $oWkS->{MaxRow};\n            $iR++\n            )\n        {\n\n            $ExcelWorkSheet .= \"<tr>\\n\";\n\n            for (\n                my $iC = $oWkS->{MinCol};\n                defined $oWkS->{MaxCol} && $iC <= $oWkS->{MaxCol};\n                $iC++\n                )\n            {\n\n                $oWkC = $oWkS->{Cells}[$iR][$iC];\n\n                my $CellData = $self->escapeXML( $oWkC->Value ) if ($oWkC);\n                $ExcelWorkSheet .= \"\\t<td>\" . $CellData . \"</td>\\n\"\n                    if $CellData;\n            }\n            $ExcelWorkSheet .= \"</tr>\\n\";\n\n            $ExcelWorkBook .= $ExcelWorkSheet;\n            $ExcelWorkSheet = \"\";\n        }\n        $ExcelWorkBook .= \"</table>\\n\";\n    }\n\n    $html .= <<EOF;\n\n    $meta{title} = $title;\n\n    return ( $html, \\%meta );\n}",
      "file" : "/var/tmp/arv_6NweBF/SWISH-Filter-0.18/lib/SWISH/Filters/XLtoHTML.pm",
      "package" : "SWISH::Filters::XLtoHTML"
   }
]
